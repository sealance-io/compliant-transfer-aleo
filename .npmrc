# npm Configuration for compliant-transfer-aleo
#
# Security and performance settings for npm workspace.
#
# IMPORTANT: This file is committed to git because it contains ONLY
# project configuration, NOT secrets. Auth tokens should be stored in:
#   - ~/.npmrc (user-specific, never committed)
#   - Environment variables (CI/CD via secrets)
#   - Never in project .npmrc files (security risk)
#
# Note: We intentionally do NOT set ignore-scripts=true because:
#   - preinstall runs lockfile-lint (validates before install)
#   - postinstall runs patch-package (required for @doko-js patches)
# CI workflows use --ignore-scripts flag explicitly with controlled execution.

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# Only allow packages from the official npm registry
# Prevents registry substitution attacks
registry=https://registry.npmjs.org/

# Enforce HTTPS for all package downloads
# Prevents downgrade attacks
strict-ssl=true

# Audit settings (overridable in CI for fail-on-vulnerabilities)
# Strategy: 'moderate' for local visibility, CI uses --audit-level=high for blocking
# This allows developers to see more issues without blocking local development
# CI enforces only high/critical fixes, balancing security with productivity
audit-level=moderate

# Disable automatic funding messages (noise reduction, already in CI flags)
fund=false

# ============================================================================
# WORKSPACE SETTINGS
# ============================================================================

# Save exact versions (no ^ or ~ prefixes)
# Ensures package.json and package-lock.json stay in sync
# Works with dependabot's versioning-strategy: increase
save-exact=true

# ============================================================================
# PERFORMANCE SETTINGS
# ============================================================================

# Prefer offline cache when available (faster, more reliable)
# Benefits:
#   - Local: Faster installs after first download (~/.npm cache)
#   - CI: Synergizes with actions/setup-node cache restoration
#   - Both: Works offline if packages are cached, resilient to registry issues
# Trade-off: Uses cached packages without re-validating registry
#   (npm ci still validates integrity hashes from package-lock.json)
prefer-offline=true
